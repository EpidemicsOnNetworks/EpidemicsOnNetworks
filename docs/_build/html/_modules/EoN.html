<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>EoN &#8212; Epidemics on Networks 0.91 documentation</title>
    
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.91',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Epidemics on Networks 0.91 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for EoN</h1><div class="highlight"><pre>
<span></span><span class="sd">r&#39;&#39;&#39;</span>
<span class="sd">EoN</span>
<span class="sd">===</span>

<span class="sd">EoN (Epidemics on Networks)</span>

<span class="sd">EoN is a Python package for the simulation of epidemics on networks </span>
<span class="sd">and ODE models of disease spread.</span>

<span class="sd">The algorithms are based on the book</span>
<span class="sd">        </span>
<span class="sd">`Mathematics of epidemics on networks: from exact to approximate </span>
<span class="sd">models`</span>
<span class="sd">by Kiss, Miller &amp; Simon</span>
<span class="sd">        http://www.springer.com/book/9783319508047</span>
<span class="sd">        </span>
<span class="sd">Please cite the book if using these algorithms</span>

<span class="sd">For simulations, we assume that input networks are **NetworkX** </span>
<span class="sd">graphs; see https://networkx.github.io/</span>




<span class="sd">Distributed under MIT license.  See license.txt for full details.</span>

<span class="sd">&#39;&#39;&#39;</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;warning - EoN is not yet tested in Python 3&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;warning - EoN is currently under significant development.  Interface&quot;</span>
      <span class="o">+</span><span class="s2">&quot; may change with little if any warning until it version 1.0&quot;</span><span class="p">)</span>


<span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;Joel C. Miller, Istvan Z. Kiss, and Peter Simon&quot;</span>
<span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;0.91&quot;</span>



<div class="viewcode-block" id="EoNError"><a class="viewcode-back" href="../methods.html#EoN.EoNError">[docs]</a><span class="k">class</span> <span class="nc">EoNError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">r&#39;&#39;&#39;</span>
<span class="sd">    this will be the basic error type for EoN</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">pass</span></div>

<span class="kn">import</span> <span class="nn">simulation</span>
<span class="kn">from</span> <span class="nn">simulation</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">analytic</span>
<span class="kn">from</span> <span class="nn">analytic</span> <span class="k">import</span> <span class="o">*</span>



<div class="viewcode-block" id="subsample"><a class="viewcode-back" href="../methods.html#EoN.subsample">[docs]</a><span class="k">def</span> <span class="nf">subsample</span><span class="p">(</span><span class="n">report_times</span><span class="p">,</span> <span class="n">times</span><span class="p">,</span> <span class="n">status1</span><span class="p">,</span> <span class="n">status2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                <span class="n">status3</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="sd">r&#39;&#39;&#39;</span>
<span class="sd">    Given </span>
<span class="sd">      S, I, and/or R as lists (or other iterable) of numbers of nodes of</span>
<span class="sd">      given status at given times</span>
<span class="sd">    returns them </span>
<span class="sd">      subsampled at specific report_times.</span>
<span class="sd">      </span>
<span class="sd">    If more than one argument is given, does so as a list in order given, but </span>
<span class="sd">    skipping whichever was not included (if any not included)</span>

<span class="sd">    If only one is given then returns just that.</span>

<span class="sd">    If report_times goes longer than times, then this simply assumes the </span>
<span class="sd">    system freezes in the final state.</span>
<span class="sd">    </span>
<span class="sd">    This uses a recursive approach if multiple arguments are defined.</span>

<span class="sd">    :INPUTS:</span>

<span class="sd">    report_times : iterable (ordered)</span>
<span class="sd">                   times at which we want to know state of system</span>
<span class="sd">                   </span>
<span class="sd">    times : iterable (ordered)</span>
<span class="sd">            times at which we have the system state (assumed no change </span>
<span class="sd">            between these times)</span>
<span class="sd">            </span>
<span class="sd">    statusX (X one of 1, 2 or 3) : iterable (order corresponds to times)</span>
<span class="sd">                          generally S, I, or R</span>
<span class="sd">                          number of nodes in given status.</span>
<span class="sd">    :RETURNS:</span>

<span class="sd">    If only status1 is defined</span>
<span class="sd">        report_status1 : scipy array gives status1 subsampled just at </span>
<span class="sd">                         report_times.</span>
<span class="sd">                     </span>
<span class="sd">    If more are defined then it returns a list, either</span>
<span class="sd">        [report_status1, report_status2]</span>
<span class="sd">    or</span>
<span class="sd">        [report_status1, report_status2, report_status3]</span>
<span class="sd">        </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">report_times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">times</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="n">EoNError</span><span class="p">(</span><span class="s2">&quot;report_times[0]&lt;times[0]&quot;</span><span class="p">)</span>
        
    <span class="n">report_status1</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">next_report_index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">next_observation_index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">next_report_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">report_times</span><span class="p">):</span>
        <span class="k">while</span> <span class="n">next_observation_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">)</span> <span class="ow">and</span> \
              <span class="n">times</span><span class="p">[</span><span class="n">next_observation_index</span><span class="p">]</span><span class="o">&lt;=</span> <span class="n">report_times</span><span class="p">[</span><span class="n">next_report_index</span><span class="p">]:</span>
            <span class="n">candidate</span> <span class="o">=</span> <span class="n">status1</span><span class="p">[</span><span class="n">next_observation_index</span><span class="p">]</span>
            <span class="n">next_observation_index</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">report_status1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate</span><span class="p">)</span>
        <span class="n">next_report_index</span> <span class="o">+=</span><span class="mi">1</span>
        
    <span class="n">report_status1</span><span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">report_status1</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">status2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">status3</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">report_status2</span><span class="p">,</span> <span class="n">report_status3</span> <span class="o">=</span> <span class="n">subsample</span><span class="p">(</span><span class="n">report_times</span><span class="p">,</span> <span class="n">times</span><span class="p">,</span> <span class="n">status2</span><span class="p">,</span> <span class="n">status3</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">report_status1</span><span class="p">,</span> <span class="n">report_status2</span><span class="p">,</span> <span class="n">report_status3</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">report_status2</span> <span class="o">=</span> <span class="n">subsample</span><span class="p">(</span><span class="n">report_times</span><span class="p">,</span> <span class="n">times</span><span class="p">,</span> <span class="n">status2</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">report_status1</span><span class="p">,</span> <span class="n">report_status2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">report_status1</span></div>



<div class="viewcode-block" id="get_time_shift"><a class="viewcode-back" href="../methods.html#EoN.get_time_shift">[docs]</a><span class="k">def</span> <span class="nf">get_time_shift</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">threshold</span><span class="p">):</span>
    <span class="sd">r&#39;&#39;&#39;</span>
<span class="sd">    Identifies the first time at which L crosses a threshold.  </span>
<span class="sd">    Useful for shifting times.</span>
<span class="sd">    </span>
<span class="sd">    :INPUTS:</span>

<span class="sd">    times : list or scipy array (ordered)</span>
<span class="sd">            the times we have observations</span>
<span class="sd">    L : a list or scipy array</span>
<span class="sd">        order of L corresponds to times</span>
<span class="sd">    threshold : number</span>
<span class="sd">        a threshold value</span>

<span class="sd">    :RETURNS:</span>

<span class="sd">    t : number</span>
<span class="sd">        the first time at which L reaches or exceeds a threshold.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">times</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">L</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">&gt;=</span> <span class="n">threshold</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">t</span></div>




<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">These are the systems I want to include based on their numbering in the </span>
<span class="sd">book:</span>

<span class="sd">coded (3.7) SIS individual based</span>
<span class="sd">(3.30) SIR individual based</span>
<span class="sd">NOT coded (3.26) SIS pair based</span>
<span class="sd">(3.39) SIR pair based</span>

<span class="sd">chapter 4?</span>

<span class="sd">(5.13) SIS heterogeneous pairwise</span>
<span class="sd">(5.15) SIR heterogeneous pairwise</span>
<span class="sd">(5.18) SIS compact pairwise</span>
<span class="sd">(5.19) SIR compact pairwise</span>
<span class="sd">(5.20) SIS super compact pairwise</span>
<span class="sd">(5.22) SIR super compact pairwise</span>
<span class="sd">(5.36) SIS effective degree</span>
<span class="sd">(5.38) SIR effective degree</span>
<span class="sd">(5.43) SIR compact effective degree</span>
<span class="sd">(5.44) SIS compact effective degree = SIS compact pairwise</span>

<span class="sd">(6.2) Epidemic probability discrete time</span>
<span class="sd">(6.3) Epidemic probability continuous time</span>
<span class="sd">(6.5) Epidemic probability non-Markovian</span>
<span class="sd">(6.6) Epidemic size discrete time</span>
<span class="sd">(6.7) Epidemic size continuous time</span>
<span class="sd">(6.8) Epidemic size non-Markovian</span>
<span class="sd">(6.10) Epidemic size discrete time (large IC)</span>
<span class="sd">(6.11) Discrete-time EBCM model</span>
<span class="sd">(6.12) Continuous time EBCM model</span>

<span class="sd">(8.1) SIS pairwise contact conserving rewiring</span>
<span class="sd">(8.5) SIS eff. deg. contact conserving rewiring</span>
<span class="sd">(8.7) SIS pairwise random activation/deletion</span>
<span class="sd">(8.13) SIS eff. deg. random activation/deletion</span>
<span class="sd">(8.15) SIS pairwise link-status dependent act/del</span>
<span class="sd">(8.16) SIS link deactivation-activation on fixed networks.</span>
<span class="sd">(8.19) EBCM dynamic network</span>

<span class="sd">(9.5) SI^{K}R multistage pairwise for homogeneous</span>
<span class="sd">(9.27) SIR pairwise, constant infection duration.</span>
<span class="sd">(9.35) SIR homogeneous pairwise, general recovery</span>
<span class="sd">(9.36) SIR EBCM non-Markovian trans/recovery</span>

<span class="sd">add models that take in graph, measure degree distribution and run EBCM</span>
<span class="sd">similarly for EBCM with neighbor degrees (see barabasi_SIR.py)</span>

<span class="sd">consider explicitly defining toast graph etc.</span>

<span class="sd">SIR_pair_based --- which of 2 versions to keep, and comments need to </span>
<span class="sd">                   explain it a bit better.</span>
<span class="sd">&#39;&#39;&#39;</span>

</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Epidemics on Networks 0.91 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Joel Miller, Istvan Kiss, Peter Simon.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.3.
    </div>
  </body>
</html>